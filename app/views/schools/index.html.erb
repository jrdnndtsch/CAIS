<p id="notice"><%= notice %></p>

<div id="compare-space">
  <%= render 'compare_list'%>
</div>
<div class="content">
  <h1>Listing Schools</h1>


  <%= params[:is_checked] %>



      <% @schools.each do |school| %>
      <div class="selector"> 
        <%= check_box_tag(:compare, value=school.id, checked = false, class: 'check')%>
      </div>
      <div class="quick-info">
        <%= school.name %>
        <p><%= school.street_address %></p>
        <p><%= school.city.name %>, <%= school.city.province.name%>, <%= school.postal_code %></p>
        <%= link_to school.website_url, "http://#{school.website_url}" %>
        <%= link_to 'View Full Profile', school %>
      </div>
      <div class="quick-stats">
        <ul>
          <li>Campus Size: <span><%= school.campus_size%></span></li>
          <li>Year Founded: <span><%= school.year_founded %></span></li>
          <li>Student Body: <span><%= school.student_body_size %></span></li>
          <li>Boys: <span>school.total_boys</span></li>
          <li>Girls: <span>school.total_girls</span></li>
          <li>Boarding Grades: <span>school.boarding_grades</span></li>
          <li>Day Grades: <span>school.day_grades</span></li>
        </ul>
      </div>
         
       
        <%= link_to 'Edit', edit_school_path(school) %>
        <%= link_to 'Destroy', school, method: :delete, data: { confirm: 'Are you sure?' } %>
        
      <% end %>
 


  <button class="compare-btn">Compare</button>
  <br>
<%= link_to 'New School', new_school_path %>
</div>


<script>
$(document).ready(function() {
  var checked_array = []
  $('.check').on('change', function(){
    checked_array = []
    console.log("changed")
    console.log($(this).is(':checked'))

    if ($('.check').filter(':checked').length > 3){
      $(this).removeAttr('checked');
    }

    $('.check').filter(':checked').each(function() {
      checked_array.push(this.value)
    });

    console.log(checked_array)

  });

  $('.compare-btn').on('click', function(){

    console.log("sending this: " +checked_array)
    console.log($('.compare-modal'))
      $.ajax({
        url: 'schools',
        type: "get",
        data: { 
          is_checked : checked_array
        },
        dataType: "script"
      });



    
  });


          console.log("saved?")
    });
</script>